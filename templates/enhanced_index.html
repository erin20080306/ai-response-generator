<!DOCTYPE html>
<html lang="zh-TW" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 智能助手 - 全功能版</title>
    
    <!-- Bootstrap CSS with Replit dark theme -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/enhanced_style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h5 class="mb-0">
                        <i class="fas fa-robot me-2"></i>
                        AI 智能助手
                    </h5>
                    <button type="button" class="btn btn-outline-secondary btn-sm d-md-none" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                
                <!-- Navigation Tabs -->
                <div class="nav-tabs-container">
                    <ul class="nav nav-tabs flex-column" id="mainTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="chat-tab" data-bs-toggle="tab" data-bs-target="#chat-panel" type="button" role="tab">
                                <i class="fas fa-comments me-2"></i>對話聊天
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="files-tab" data-bs-toggle="tab" data-bs-target="#files-panel" type="button" role="tab">
                                <i class="fas fa-file-upload me-2"></i>檔案處理
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tools-tab" data-bs-toggle="tab" data-bs-target="#tools-panel" type="button" role="tab">
                                <i class="fas fa-tools me-2"></i>實用工具
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-panel" type="button" role="tab">
                                <i class="fas fa-cog me-2"></i>個人設定
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="collaborate-tab" data-bs-toggle="tab" data-bs-target="#collaborate-panel" type="button" role="tab">
                                <i class="fas fa-users me-2"></i>協作功能
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="games-tab" data-bs-toggle="tab" data-bs-target="#games-panel" type="button" role="tab">
                                <i class="fas fa-gamepad me-2"></i>遊戲中心
                            </button>
                        </li>
                    </ul>
                </div>
                
                <!-- Chat History -->
                <div class="chat-history mt-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="mb-0">對話記錄</h6>
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="newChatBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="chatHistoryList" class="chat-history-list">
                        <!-- Chat history items will be loaded here -->
                    </div>
                </div>
                
                <!-- Quick Replies -->
                <div class="quick-replies mt-3">
                    <h6 class="mb-2">快速回覆</h6>
                    <div id="quickRepliesList" class="quick-replies-list">
                        <!-- Quick replies will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 main-content">
                <div class="tab-content h-100" id="mainTabsContent">
                    <!-- Chat Panel -->
                    <div class="tab-pane fade show active h-100" id="chat-panel" role="tabpanel">
                        <div class="chat-container h-100">
                            <!-- Chat Header -->
                            <div class="chat-header">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <h4 class="mb-0 me-3">AI 對話助手</h4>
                                        <span class="badge bg-success" id="connectionStatus">已連線</span>
                                    </div>
                                    <div class="header-controls">
                                        <button type="button" class="btn btn-outline-secondary btn-sm me-2" id="voiceToggleBtn">
                                            <i class="fas fa-microphone"></i>
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm me-2" id="bookmarkBtn">
                                            <i class="fas fa-bookmark"></i>
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm me-2" id="shareBtn">
                                            <i class="fas fa-share"></i>
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm me-2" id="exportBtn">
                                            <i class="fas fa-download"></i>
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" id="clearHistoryBtn">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat Messages -->
                            <div id="chatMessages" class="chat-messages">
                                <div class="message-item system-message">
                                    <div class="message-content">
                                        <i class="fas fa-robot me-2"></i>
                                        歡迎使用 AI 智能助手！我現在具備以下功能：
                                        <ul class="mt-2 mb-0">
                                            <li>💬 智能對話與問答</li>
                                            <li>📁 檔案上傳與分析</li>
                                            <li>🛠️ 實用工具集合</li>
                                            <li>🎨 個人化設定</li>
                                            <li>👥 協作功能</li>
                                            <li>🔊 語音輸入輸出</li>
                                            <li>📊 數據分析與視覺化</li>
                                            <li>🌍 翻譯與國際化</li>
                                        </ul>
                                        請選擇功能開始使用！
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Input Area -->
                            <div class="input-area">
                                <div class="input-wrapper">
                                    <div class="input-group">
                                        <button class="btn btn-outline-secondary" type="button" id="fileUploadBtn">
                                            <i class="fas fa-paperclip"></i>
                                        </button>
                                        <input type="file" id="fileInput" multiple accept=".txt,.doc,.docx,.pdf,.png,.jpg,.jpeg,.gif,.csv,.xlsx,.xls,.ppt,.pptx" style="display: none;">
                                        <textarea class="form-control" id="messageInput" placeholder="輸入訊息... (按 Ctrl+Enter 發送)" rows="1"></textarea>
                                        <button class="btn btn-outline-secondary" type="button" id="voiceInputBtn">
                                            <i class="fas fa-microphone"></i>
                                        </button>
                                        <button class="btn btn-primary" type="button" id="sendBtn">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    <div class="input-status" id="inputStatus"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Files Panel -->
                    <div class="tab-pane fade" id="files-panel" role="tabpanel">
                        <div class="panel-container">
                            <h4 class="mb-4">檔案處理中心</h4>
                            
                            <!-- File Upload Section -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-upload me-2"></i>檔案上傳</h5>
                                </div>
                                <div class="card-body">
                                    <div class="upload-area" id="uploadArea">
                                        <div class="upload-content">
                                            <i class="fas fa-cloud-upload-alt fa-3x mb-3"></i>
                                            <h5>拖拽檔案到此處或點擊上傳</h5>
                                            <p class="text-muted">支援文件、圖片、音頻、視頻等多種格式</p>
                                            <button type="button" class="btn btn-primary" id="selectFilesBtn">
                                                <i class="fas fa-folder-open me-2"></i>選擇檔案
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- File List -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-list me-2"></i>已上傳檔案</h5>
                                </div>
                                <div class="card-body">
                                    <div id="filesList" class="files-list">
                                        <!-- Uploaded files will appear here -->
                                        <div class="text-center text-muted">
                                            <i class="fas fa-inbox fa-2x mb-2"></i>
                                            <p>尚未上傳任何檔案</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- File Analysis -->
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>檔案分析結果</h5>
                                </div>
                                <div class="card-body">
                                    <div id="analysisResults" class="analysis-results">
                                        <!-- Analysis results will appear here -->
                                        <div class="text-center text-muted">
                                            <i class="fas fa-search fa-2x mb-2"></i>
                                            <p>選擇檔案進行分析</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tools Panel -->
                    <div class="tab-pane fade" id="tools-panel" role="tabpanel">
                        <div class="panel-container">
                            <h4 class="mb-4">實用工具</h4>
                            
                            <div class="row">
                                <!-- Calculator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-calculator fa-2x mb-3"></i>
                                            <h5>計算機</h5>
                                            <p class="text-muted">強大的數學計算工具</p>
                                            <button type="button" class="btn btn-primary" id="calculatorBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- QR Code Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-qrcode fa-2x mb-3"></i>
                                            <h5>QR碼生成器</h5>
                                            <p class="text-muted">生成自訂QR碼</p>
                                            <button type="button" class="btn btn-primary" id="qrCodeBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Barcode Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-barcode fa-2x mb-3"></i>
                                            <h5>條碼生成器</h5>
                                            <p class="text-muted">生成各種條碼格式</p>
                                            <button type="button" class="btn btn-primary" id="barcodeBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Design Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-palette fa-2x mb-3"></i>
                                            <h5>Canva式設計</h5>
                                            <p class="text-muted">AI自動設計生成</p>
                                            <button type="button" class="btn btn-primary" id="designBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Password Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-key fa-2x mb-3"></i>
                                            <h5>密碼生成器</h5>
                                            <p class="text-muted">生成安全密碼</p>
                                            <button type="button" class="btn btn-primary" id="passwordGenBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- URL Shortener -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-link fa-2x mb-3"></i>
                                            <h5>網址縮短</h5>
                                            <p class="text-muted">縮短長網址</p>
                                            <button type="button" class="btn btn-primary" id="urlShortenerBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Date Time Converter -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-clock fa-2x mb-3"></i>
                                            <h5>時間轉換</h5>
                                            <p class="text-muted">時間格式轉換</p>
                                            <button type="button" class="btn btn-primary" id="dateTimeBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Color Picker -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-palette fa-2x mb-3"></i>
                                            <h5>顏色選擇器</h5>
                                            <p class="text-muted">選擇和轉換顏色</p>
                                            <button type="button" class="btn btn-primary" id="colorPickerBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Panel -->
                    <div class="tab-pane fade" id="settings-panel" role="tabpanel">
                        <div class="panel-container">
                            <h4 class="mb-4">個人設定</h4>
                            
                            <div class="row">
                                <div class="col-lg-8">
                                    <!-- Appearance Settings -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-palette me-2"></i>外觀設定</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="themeSelect" class="form-label">主題</label>
                                                    <select class="form-select" id="themeSelect">
                                                        <option value="dark">深色主題</option>
                                                        <option value="light">淺色主題</option>
                                                        <option value="auto">跟隨系統</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="fontSizeSelect" class="form-label">字體大小</label>
                                                    <select class="form-select" id="fontSizeSelect">
                                                        <option value="small">小</option>
                                                        <option value="medium" selected>中</option>
                                                        <option value="large">大</option>
                                                        <option value="xl">特大</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- AI Settings -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-robot me-2"></i>AI 設定</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="aiToneSelect" class="form-label">AI 語氣</label>
                                                    <select class="form-select" id="aiToneSelect">
                                                        <option value="friendly" selected>友善</option>
                                                        <option value="professional">專業</option>
                                                        <option value="casual">輕鬆</option>
                                                        <option value="formal">正式</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="typingSpeedRange" class="form-label">打字速度</label>
                                                    <input type="range" class="form-range" id="typingSpeedRange" min="20" max="100" value="50">
                                                    <div class="d-flex justify-content-between">
                                                        <small>慢</small>
                                                        <small>快</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="typewriterEffect" checked>
                                                <label class="form-check-label" for="typewriterEffect">
                                                    啟用逐字顯示效果
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Voice Settings -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-volume-up me-2"></i>語音設定</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-check mb-3">
                                                <input class="form-check-input" type="checkbox" id="voiceInput">
                                                <label class="form-check-label" for="voiceInput">
                                                    啟用語音輸入
                                                </label>
                                            </div>
                                            <div class="form-check mb-3">
                                                <input class="form-check-input" type="checkbox" id="voiceOutput">
                                                <label class="form-check-label" for="voiceOutput">
                                                    啟用語音輸出
                                                </label>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="voiceLanguage" class="form-label">語音語言</label>
                                                    <select class="form-select" id="voiceLanguage">
                                                        <option value="zh-TW" selected>繁體中文</option>
                                                        <option value="zh-CN">簡體中文</option>
                                                        <option value="en-US">英語 (美國)</option>
                                                        <option value="ja-JP">日語</option>
                                                        <option value="ko-KR">韓語</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="voiceSpeed" class="form-label">語音速度</label>
                                                    <input type="range" class="form-range" id="voiceSpeed" min="0.5" max="2" step="0.1" value="1">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-lg-4">
                                    <!-- Quick Actions -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-lightning-bolt me-2"></i>快速動作</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="d-grid gap-2">
                                                <button type="button" class="btn btn-outline-primary" id="exportSettingsBtn">
                                                    <i class="fas fa-download me-2"></i>匯出設定
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" id="importSettingsBtn">
                                                    <i class="fas fa-upload me-2"></i>匯入設定
                                                </button>
                                                <button type="button" class="btn btn-outline-warning" id="resetSettingsBtn">
                                                    <i class="fas fa-undo me-2"></i>重設預設值
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Storage Info -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-hdd me-2"></i>儲存空間</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>對話記錄</span>
                                                    <span id="chatStorageUsed">0 MB</span>
                                                </div>
                                                <div class="progress">
                                                    <div class="progress-bar" id="chatStorageBar" style="width: 0%"></div>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <div class="d-flex justify-content-between">
                                                    <span>上傳檔案</span>
                                                    <span id="fileStorageUsed">0 MB</span>
                                                </div>
                                                <div class="progress">
                                                    <div class="progress-bar" id="fileStorageBar" style="width: 0%"></div>
                                                </div>
                                            </div>
                                            <div class="text-center">
                                                <button type="button" class="btn btn-outline-danger btn-sm" id="clearStorageBtn">
                                                    <i class="fas fa-trash me-2"></i>清除所有資料
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Collaborate Panel -->
                    <div class="tab-pane fade" id="collaborate-panel" role="tabpanel">
                        <div class="panel-container">
                            <h4 class="mb-4">協作功能</h4>
                            
                            <div class="row">
                                <div class="col-lg-8">
                                    <!-- Create Room -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-plus-circle me-2"></i>創建協作房間</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="roomName" class="form-label">房間名稱</label>
                                                    <input type="text" class="form-control" id="roomName" placeholder="輸入房間名稱">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="maxParticipants" class="form-label">最大參與者</label>
                                                    <select class="form-select" id="maxParticipants">
                                                        <option value="2">2 人</option>
                                                        <option value="5">5 人</option>
                                                        <option value="10" selected>10 人</option>
                                                        <option value="20">20 人</option>
                                                        <option value="50">50 人</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-primary" id="createRoomBtn">
                                                <i class="fas fa-door-open me-2"></i>創建房間
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Join Room -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-sign-in-alt me-2"></i>加入協作房間</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="roomCode" placeholder="輸入房間代碼">
                                                <button type="button" class="btn btn-primary" id="joinRoomBtn">
                                                    <i class="fas fa-sign-in-alt me-2"></i>加入
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Active Rooms -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-users me-2"></i>活躍房間</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="activeRoomsList" class="active-rooms-list">
                                                <!-- Active rooms will appear here -->
                                                <div class="text-center text-muted">
                                                    <i class="fas fa-door-closed fa-2x mb-2"></i>
                                                    <p>暫無活躍房間</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-lg-4">
                                    <!-- Current Room Info -->
                                    <div class="card mb-4" id="currentRoomCard" style="display: none;">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>當前房間</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="currentRoomInfo">
                                                <!-- Current room info will appear here -->
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Participants -->
                                    <div class="card" id="participantsCard" style="display: none;">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-users me-2"></i>參與者</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="participantsList" class="participants-list">
                                                <!-- Participants will appear here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Games Panel -->
                    <div class="tab-pane fade" id="games-panel" role="tabpanel">
                        <div class="panel-container">
                            <h4 class="mb-4">遊戲中心</h4>
                            
                            <div class="row">
                                <div class="col-lg-8">
                                    <!-- Game Selection -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-gamepad me-2"></i>遊戲選擇</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-4 mb-3">
                                                    <div class="card text-center game-card" onclick="loadGame('tetris')">
                                                        <div class="card-body">
                                                            <i class="fas fa-th-large fa-2x mb-2 text-primary"></i>
                                                            <h5 class="card-title">俄羅斯方塊</h5>
                                                            <p class="card-text">經典的俄羅斯方塊遊戲</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <div class="card text-center game-card" onclick="loadGame('mahjong')">
                                                        <div class="card-body">
                                                            <i class="fas fa-square fa-2x mb-2 text-success"></i>
                                                            <h5 class="card-title">麻將</h5>
                                                            <p class="card-text">4人麻將遊戲</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 mb-3">
                                                    <div class="card text-center game-card" onclick="loadGame('farm')">
                                                        <div class="card-body">
                                                            <i class="fas fa-seedling fa-2x mb-2 text-warning"></i>
                                                            <h5 class="card-title">農場物語</h5>
                                                            <p class="card-text">農場模擬RPG遊戲</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Game Container -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-play me-2"></i>遊戲畫面</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="gameContainer" class="game-container">
                                                <div class="text-center text-muted">
                                                    <i class="fas fa-gamepad fa-3x mb-3"></i>
                                                    <h5>請選擇一個遊戲開始</h5>
                                                    <p>點擊上方的遊戲卡片來載入遊戲</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-lg-4">
                                    <!-- Game Info -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>遊戲資訊</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="gameInfo">
                                                <p>選擇遊戲後將顯示相關資訊</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Game Controls -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-cog me-2"></i>遊戲控制</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="gameControls">
                                                <p>遊戲載入後將顯示控制選項</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner-border text-primary mb-3" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="loading-text">處理中...</div>
        </div>
    </div>
    
    <!-- Modals -->
    <!-- QR Code Generator Modal -->
    <div class="modal fade" id="qrCodeModal" tabindex="-1" aria-labelledby="qrCodeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="qrCodeModalLabel">QR碼生成器</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="qrText" class="form-label">輸入文字或網址</label>
                        <textarea class="form-control" id="qrText" rows="3" placeholder="請輸入要生成QR碼的文字或網址"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="qrSize" class="form-label">大小</label>
                            <select class="form-select" id="qrSize">
                                <option value="8">小 (8)</option>
                                <option value="10" selected>中 (10)</option>
                                <option value="12">大 (12)</option>
                                <option value="15">特大 (15)</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="qrBorder" class="form-label">邊框</label>
                            <select class="form-select" id="qrBorder">
                                <option value="2">窄 (2)</option>
                                <option value="4" selected>標準 (4)</option>
                                <option value="6">寬 (6)</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-primary" id="generateQRBtn">生成QR碼</button>
                        <button type="button" class="btn btn-success" id="downloadQRBtn" style="display:none;">下載QR碼</button>
                    </div>
                    <div id="qrResult" class="mt-3 text-center" style="display:none;">
                        <img id="qrImage" src="" alt="QR Code" class="img-fluid" style="max-width: 300px;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Barcode Generator Modal -->
    <div class="modal fade" id="barcodeModal" tabindex="-1" aria-labelledby="barcodeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="barcodeModalLabel">條碼生成器</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="barcodeText" class="form-label">輸入文字或數字</label>
                        <input type="text" class="form-control" id="barcodeText" placeholder="請輸入要生成條碼的文字或數字">
                    </div>
                    <div class="mb-3">
                        <label for="barcodeType" class="form-label">條碼類型</label>
                        <select class="form-select" id="barcodeType">
                            <option value="code128" selected>Code 128</option>
                            <option value="code39">Code 39</option>
                            <option value="ean13">EAN-13</option>
                            <option value="ean8">EAN-8</option>
                            <option value="upc">UPC-A</option>
                            <option value="isbn13">ISBN-13</option>
                            <option value="isbn10">ISBN-10</option>
                            <option value="issn">ISSN</option>
                        </select>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-primary" id="generateBarcodeBtn">生成條碼</button>
                        <button type="button" class="btn btn-success" id="downloadBarcodeBtn" style="display:none;">下載條碼</button>
                    </div>
                    <div id="barcodeResult" class="mt-3 text-center" style="display:none;">
                        <img id="barcodeImage" src="" alt="Barcode" class="img-fluid" style="max-width: 400px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-html.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/enhanced_app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/file_handler.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tools.js') }}"></script>
    <script src="{{ url_for('static', filename='js/voice.js') }}"></script>
    <script src="{{ url_for('static', filename='js/collaboration.js') }}"></script>
    <script src="{{ url_for('static', filename='js/games_standalone.js') }}"></script>
    <script src="{{ url_for('static', filename='js/document_generator.js') }}"></script>

            const gameContainer = document.getElementById('gameContainer');
            const gameInfo = document.getElementById('gameInfo');
            const gameControls = document.getElementById('gameControls');
            
            gameInfo.innerHTML = '<h6>麻將</h6><p>4人麻將遊戲，點擊牌張進行遊戲</p>';
            gameControls.innerHTML = '<button class="btn btn-primary" onclick="startMahjongInPanel()">開始遊戲</button>';
            
            // 直接載入麻將遊戲
            startMahjongInPanel();
        }
        
        function loadFarmStoryGame() {
            const gameContainer = document.getElementById('gameContainer');
            const gameInfo = document.getElementById('gameInfo');
            const gameControls = document.getElementById('gameControls');
            
            gameInfo.innerHTML = '<h6>農場物語</h6><p>農場RPG遊戲，與NPC對話並管理農場</p>';
            gameControls.innerHTML = '<button class="btn btn-primary" onclick="startFarmStoryInPanel()">開始遊戲</button>';
            
            // 直接載入農場故事遊戲
            startFarmStoryInPanel();
        }
        }
        
        // 全域遊戲啟動函數
        function startTetrisInPanel() {
            const gameContainer = document.getElementById('gameContainer');
            gameContainer.innerHTML = `
                <div class="tetris-container text-center">
                    <h5>俄羅斯方塊</h5>
                    <canvas id="tetrisCanvas" width="300" height="600" style="border: 1px solid #ccc;"></canvas>
                    <div class="mt-3">
                        <p>使用方向鍵控制：← → ↓ 移動，↑ 旋轉</p>
                        <button class="btn btn-success" onclick="initTetrisGame()">重新開始</button>
                    </div>
                </div>
            `;
            initTetrisGame();
        }
        
        function startMahjongInPanel() {
            const gameContainer = document.getElementById('gameContainer');
            gameContainer.innerHTML = `
                <div class="mahjong-container">
                    <h5 class="text-center mb-3">麻將遊戲</h5>
                    <div id="mahjongBoard" class="mahjong-board"></div>
                    <div class="text-center mt-3">
                        <button class="btn btn-success" onclick="initMahjongGame()">開始新局</button>
                    </div>
                </div>
            `;
            initMahjongGame();
        }
        
        function startFarmStoryInPanel() {
            const gameContainer = document.getElementById('gameContainer');
            gameContainer.innerHTML = `
                <div class="farm-story-container">
                    <h5 class="text-center mb-3">農場物語</h5>
                    <div id="farmStoryBoard" class="farm-story-board"></div>
                    <div class="text-center mt-3">
                        <button class="btn btn-success" onclick="initFarmStoryGame()">開始遊戲</button>
                    </div>
                </div>
            `;
            initFarmStoryGame();
        }
        
        // 簡化的遊戲初始化函數
        function initTetrisGame() {
            console.log('初始化俄羅斯方塊遊戲');
            // 這裡可以添加實際的俄羅斯方塊遊戲邏輯
        }
        
        function initMahjongGame() {
            const board = document.getElementById('mahjongBoard');
            board.innerHTML = `
                <div class="text-center">
                    <p>4人麻將遊戲準備中...</p>
                    <div class="mahjong-tiles">
                        <div class="tile">🀄</div>
                        <div class="tile">🀅</div>
                        <div class="tile">🀆</div>
                        <div class="tile">🀇</div>
                    </div>
                </div>
            `;
        }
        
        function initFarmStoryGame() {
            const board = document.getElementById('farmStoryBoard');
            board.innerHTML = `
                <div class="farm-story-ui">
                    <div class="story-panel">
                        <h6>歡迎來到農場物語！</h6>
                        <p>你繼承了祖父的農場，開始你的農場生活吧！</p>
                        <div class="npc-area">
                            <button class="btn btn-sm btn-outline-primary me-2" onclick="talkToNPC('村長湯姆')">村長湯姆</button>
                            <button class="btn btn-sm btn-outline-success me-2" onclick="talkToNPC('商店老闆瑪麗')">商店瑪麗</button>
                            <button class="btn btn-sm btn-outline-warning me-2" onclick="talkToNPC('鐵匠傑克')">鐵匠傑克</button>
                            <button class="btn btn-sm btn-outline-info" onclick="talkToNPC('醫生莉莉')">醫生莉莉</button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function talkToNPC(npcName) {
            const board = document.getElementById('farmStoryBoard');
            let dialogue = '';
            
            switch(npcName) {
                case '村長湯姆':
                    dialogue = `
                        <div class="dialogue-box">
                            <h6>村長湯姆</h6>
                            <p>"歡迎回到農場！你祖父的農場需要你的照料。要不要先去田裡種些作物？"</p>
                            <button class="btn btn-sm btn-primary" onclick="goToFarm()">去農場</button>
                            <button class="btn btn-sm btn-secondary" onclick="initFarmStoryGame()">回到主畫面</button>
                        </div>
                    `;
                    break;
                case '商店老闆瑪麗':
                    dialogue = `
                        <div class="dialogue-box">
                            <h6>商店老闆瑪麗</h6>
                            <p>"需要種子嗎？我這裡有新鮮的蘿蔔和玉米種子！"</p>
                            <button class="btn btn-sm btn-success" onclick="buySeeds()">購買種子</button>
                            <button class="btn btn-sm btn-secondary" onclick="initFarmStoryGame()">回到主畫面</button>
                        </div>
                    `;
                    break;
                case '鐵匠傑克':
                    dialogue = `
                        <div class="dialogue-box">
                            <h6>鐵匠傑克</h6>
                            <p>"你的農具需要升級了！讓我幫你打造更好的工具吧！"</p>
                            <button class="btn btn-sm btn-warning" onclick="upgradeTools()">升級工具</button>
                            <button class="btn btn-sm btn-secondary" onclick="initFarmStoryGame()">回到主畫面</button>
                        </div>
                    `;
                    break;
                case '醫生莉莉':
                    dialogue = `
                        <div class="dialogue-box">
                            <h6>醫生莉莉</h6>
                            <p>"農場生活辛苦，記得照顧好自己的健康！這裡有一些恢復藥水。"</p>
                            <button class="btn btn-sm btn-info" onclick="getHealing()">獲得治療</button>
                            <button class="btn btn-sm btn-secondary" onclick="initFarmStoryGame()">回到主畫面</button>
                        </div>
                    `;
                    break;
            }
            
            board.innerHTML = dialogue;
        }
        
        function goToFarm() {
            const board = document.getElementById('farmStoryBoard');
            board.innerHTML = `
                <div class="farm-scene">
                    <h6>農場</h6>
                    <p>這是你的農場，土地肥沃等待耕作。</p>
                    <div class="farm-actions">
                        <button class="btn btn-sm btn-success me-2" onclick="plantCrops()">種植作物</button>
                        <button class="btn btn-sm btn-primary me-2" onclick="waterCrops()">澆水</button>
                        <button class="btn btn-sm btn-warning me-2" onclick="harvestCrops()">收穫</button>
                        <button class="btn btn-sm btn-secondary" onclick="initFarmStoryGame()">回村莊</button>
                    </div>
                    <div id="farmStatus" class="mt-3">
                        <p>農場狀態：準備耕作</p>
                    </div>
                </div>
            `;
        }
        
        function buySeeds() {
            showMessage('你購買了蘿蔔種子和玉米種子！');
        }
        
        function upgradeTools() {
            showMessage('你的農具已升級！效率提升了！');
        }
        
        function getHealing() {
            showMessage('你感到精神百倍！健康值恢復！');
        }
        
        function plantCrops() {
            document.getElementById('farmStatus').innerHTML = '<p class="text-success">你種下了種子！記得澆水哦。</p>';
        }
        
        function waterCrops() {
            document.getElementById('farmStatus').innerHTML = '<p class="text-info">你給作物澆了水，它們正在茁壯成長！</p>';
        }
        
        function harvestCrops() {
            document.getElementById('farmStatus').innerHTML = '<p class="text-warning">你收穫了成熟的作物！獲得了金幣！</p>';
        }
        
        function showMessage(message) {
            const board = document.getElementById('farmStoryBoard');
            board.innerHTML = `
                <div class="message-box text-center">
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="initFarmStoryGame()">繼續</button>
                </div>
            `;
        }
    </script>
</body>
</html>