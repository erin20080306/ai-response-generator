<!DOCTYPE html>
<html lang="zh-TW" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 智能助手 - 全功能版</title>
    
    <!-- Bootstrap CSS with Replit dark theme -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/enhanced_style.css') }}?v=2.0" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/simple_games.css') }}?v=2.0" rel="stylesheet">
</head>
<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h5 class="mb-0">
                        <i class="fas fa-robot me-2"></i>
                        AI 智能助手
                    </h5>
                    <button type="button" class="btn btn-outline-secondary btn-sm d-md-none" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                
                <!-- Navigation Tabs -->
                <div class="nav-tabs-container">
                    <ul class="nav nav-tabs flex-column" id="mainTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="chat-tab" data-bs-toggle="tab" data-bs-target="#chat-panel" type="button" role="tab">
                                <i class="fas fa-comments me-2"></i>對話聊天
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="files-tab" data-bs-toggle="tab" data-bs-target="#files-panel" type="button" role="tab">
                                <i class="fas fa-file-upload me-2"></i>檔案處理
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tools-tab" data-bs-toggle="tab" data-bs-target="#tools-panel" type="button" role="tab">
                                <i class="fas fa-tools me-2"></i>實用工具
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="games-tab" data-bs-toggle="tab" data-bs-target="#games-panel" type="button" role="tab">
                                <i class="fas fa-gamepad me-2"></i>遊戲娛樂
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-panel" type="button" role="tab">
                                <i class="fas fa-cog me-2"></i>個人設定
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 main-content">
                <div class="tab-content h-100" id="mainTabsContent">
                    <!-- Chat Panel -->
                    <div class="tab-pane fade show active h-100" id="chat-panel" role="tabpanel">
                        <div class="chat-container h-100 d-flex flex-column">
                            <!-- AI Assistant Avatar & Settings -->
                            <div class="ai-avatar-container mb-3">
                                <div class="d-flex align-items-center">
                                    <div class="ai-avatar me-3">
                                        <i class="fas fa-robot fa-2x" id="aiAvatarIcon"></i>
                                    </div>
                                    <div class="ai-info">
                                        <h5 class="mb-0" id="aiNameDisplay">AI 助手</h5>
                                        <small class="text-muted" id="aiPersonalityDisplay">友善親切</small>
                                    </div>
                                    <div class="ms-auto">
                                        <button type="button" class="btn btn-outline-secondary btn-sm" id="clearChatBtn">
                                            <i class="fas fa-trash me-1"></i>清除對話
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat Messages -->
                            <div class="chat-messages flex-grow-1" id="chatMessages">
                                <div class="message assistant-message">
                                    <div class="message-content">
                                        <i class="fas fa-robot me-2"></i>
                                        <div class="message-text">
                                            <p>您好！我是您的AI智能助手，具備以下功能：</p>
                                            <ul>
                                                <li>🤖 智能對話與問答</li>
                                                <li>🎨 圖像生成與分析</li>
                                                <li>🎵 語音輸入與輸出</li>
                                                <li>📁 檔案處理與分析</li>
                                                <li>🛠️ 實用工具集合</li>
                                                <li>🎮 遊戲娛樂功能</li>
                                            </ul>
                                            <p>請告訴我您需要什麼幫助！</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat Input -->
                            <div class="chat-input-container">
                                <div class="input-group">
                                    <textarea class="form-control" id="messageInput" placeholder="在此輸入您的訊息..." rows="2"></textarea>
                                    <button class="btn btn-primary" type="button" id="sendBtn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                                <div class="input-tools mt-2">
                                    <button type="button" class="btn btn-outline-secondary btn-sm" id="attachFileBtn">
                                        <i class="fas fa-paperclip me-1"></i>附加檔案
                                    </button>
                                    <button type="button" class="btn btn-outline-info btn-sm" id="generateImageBtn">
                                        <i class="fas fa-image me-1"></i>生成圖片
                                    </button>
                                    <button type="button" class="btn btn-outline-warning btn-sm" id="voiceOutputBtn">
                                        <i class="fas fa-volume-up me-1"></i>語音播放
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Files Panel -->
                    <div class="tab-pane fade h-100" id="files-panel" role="tabpanel">
                        <div class="files-container h-100 d-flex flex-column">
                            <div class="files-header">
                                <h4 class="mb-3">
                                    <i class="fas fa-file-upload me-2"></i>
                                    檔案處理中心
                                </h4>
                                <p class="text-muted">支援圖片、文件、音頻等多種檔案格式的上傳與分析</p>
                            </div>
                            
                            <!-- File Upload Area -->
                            <div class="file-upload-area mb-4">
                                <div class="upload-zone" id="uploadZone">
                                    <div class="upload-content">
                                        <i class="fas fa-cloud-upload-alt fa-3x mb-3"></i>
                                        <h5>拖拽檔案到此處或點擊選擇</h5>
                                        <p class="text-muted">支援圖片、文件、音頻等格式</p>
                                        <button type="button" class="btn btn-primary" id="selectFilesBtn">
                                            <i class="fas fa-folder-open me-2"></i>選擇檔案
                                        </button>
                                    </div>
                                </div>
                                <input type="file" id="fileInputPanel" multiple style="display: none;">
                            </div>
                            
                            <!-- File List -->
                            <div class="file-list-container">
                                <h5 class="mb-3">已上傳的檔案</h5>
                                <div class="file-list" id="fileList">
                                    <div class="no-files-message text-center text-muted">
                                        <i class="fas fa-folder-open fa-2x mb-2"></i>
                                        <p>尚未上傳任何檔案</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tools Panel -->
                    <div class="tab-pane fade h-100" id="tools-panel" role="tabpanel">
                        <div class="tools-container h-100">
                            <div class="tools-header mb-4">
                                <h4 class="mb-3">
                                    <i class="fas fa-tools me-2"></i>
                                    實用工具集
                                </h4>
                                <p class="text-muted">提供各種實用工具，提升您的工作效率</p>
                            </div>
                            
                            <div class="row">
                                <!-- QR Code Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-qrcode fa-2x mb-3"></i>
                                            <h5>QR碼生成器</h5>
                                            <p class="text-muted">快速生成QR碼</p>
                                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#qrCodeModal">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Barcode Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-barcode fa-2x mb-3"></i>
                                            <h5>條碼生成器</h5>
                                            <p class="text-muted">生成各種條碼</p>
                                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#barcodeModal">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Color Picker -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-palette fa-2x mb-3"></i>
                                            <h5>顏色選擇器</h5>
                                            <p class="text-muted">選擇和轉換顏色</p>
                                            <button type="button" class="btn btn-primary" id="colorPickerBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Document Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-file-alt fa-2x mb-3"></i>
                                            <h5>AI文件生成</h5>
                                            <p class="text-muted">Excel、Word、PPT自動生成</p>
                                            <button type="button" class="btn btn-primary" id="documentGenBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Password Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-key fa-2x mb-3"></i>
                                            <h5>密碼生成器</h5>
                                            <p class="text-muted">生成安全密碼</p>
                                            <button type="button" class="btn btn-primary" id="passwordGenBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Calculator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-calculator fa-2x mb-3"></i>
                                            <h5>計算器</h5>
                                            <p class="text-muted">基本計算功能</p>
                                            <button type="button" class="btn btn-primary" id="calculatorBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Design Generator -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-paint-brush fa-2x mb-3"></i>
                                            <h5>Canva設計生成</h5>
                                            <p class="text-muted">AI圖片設計生成</p>
                                            <button type="button" class="btn btn-primary" id="designGenBtn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Base64 Encoder -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card tool-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-code fa-2x mb-3"></i>
                                            <h5>Base64 編碼器</h5>
                                            <p class="text-muted">文字編碼解碼</p>
                                            <button type="button" class="btn btn-primary" id="base64Btn">
                                                開啟
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Games Panel -->
                    <div class="tab-pane fade h-100" id="games-panel" role="tabpanel">
                        <div class="games-container h-100">
                            <div class="games-header mb-4">
                                <h4 class="mb-3">
                                    <i class="fas fa-gamepad me-2"></i>
                                    遊戲娛樂中心
                                </h4>
                                <p class="text-muted">多款精彩遊戲等您體驗</p>
                            </div>
                            
                            <div class="row">
                                <!-- Tetris -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card game-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-th-large fa-2x mb-3"></i>
                                            <h5>俄羅斯方塊</h5>
                                            <p class="text-muted">經典益智遊戲</p>
                                            <button type="button" class="btn btn-primary" onclick="openGame('tetris')">
                                                開始遊戲
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Mahjong -->
                                <div class="col-md-6 col-lg-4 mb-4">
                                    <div class="card game-card">
                                        <div class="card-body text-center">
                                            <i class="fas fa-dice fa-2x mb-3"></i>
                                            <h5>麻將遊戲</h5>
                                            <p class="text-muted">四人麻將對戰</p>
                                            <button type="button" class="btn btn-primary" onclick="openGame('mahjong')">
                                                開始遊戲
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Panel -->
                    <div class="tab-pane fade h-100" id="settings-panel" role="tabpanel">
                        <div class="settings-container h-100">
                            <div class="settings-header mb-4">
                                <h4 class="mb-3">
                                    <i class="fas fa-cog me-2"></i>
                                    個人設定
                                </h4>
                                <p class="text-muted">自訂您的使用體驗</p>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-8">
                                    <!-- AI 助手設定 -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0">
                                                <i class="fas fa-robot me-2"></i>
                                                AI 助手設定
                                            </h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="aiName" class="form-label">助手名稱</label>
                                                <input type="text" class="form-control" id="aiName" placeholder="為您的AI助手取個名字">
                                            </div>
                                            <div class="mb-3">
                                                <label for="aiPersonality" class="form-label">個性設定</label>
                                                <select class="form-select" id="aiPersonality">
                                                    <option value="friendly">友善親切</option>
                                                    <option value="professional">專業正式</option>
                                                    <option value="casual">輕鬆隨性</option>
                                                    <option value="humorous">幽默風趣</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="aiAvatar" class="form-label">頭像選擇</label>
                                                <div class="avatar-options">
                                                    <div class="avatar-option" data-avatar="robot">
                                                        <i class="fas fa-robot"></i>
                                                    </div>
                                                    <div class="avatar-option" data-avatar="user-astronaut">
                                                        <i class="fas fa-user-astronaut"></i>
                                                    </div>
                                                    <div class="avatar-option" data-avatar="cat">
                                                        <i class="fas fa-cat"></i>
                                                    </div>
                                                    <div class="avatar-option" data-avatar="dog">
                                                        <i class="fas fa-dog"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-primary" id="saveAISettingsBtn">
                                                儲存設定
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- 介面設定 -->
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0">
                                                <i class="fas fa-palette me-2"></i>
                                                介面設定
                                            </h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label for="themeSelect" class="form-label">主題選擇</label>
                                                <select class="form-select" id="themeSelect">
                                                    <option value="dark">深色主題</option>
                                                    <option value="light">淺色主題</option>
                                                    <option value="auto">自動切換</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="fontSize" class="form-label">字體大小</label>
                                                <select class="form-select" id="fontSize">
                                                    <option value="small">小</option>
                                                    <option value="medium">中</option>
                                                    <option value="large">大</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="typingSpeed" class="form-label">打字效果速度</label>
                                                <input type="range" class="form-range" id="typingSpeed" min="10" max="100" value="50">
                                                <div class="d-flex justify-content-between text-muted">
                                                    <small>慢</small>
                                                    <small>快</small>
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-primary" id="saveInterfaceSettingsBtn">
                                                儲存設定
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-4">
                                    <!-- 助手預覽 -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0">預覽</h6>
                                        </div>
                                        <div class="card-body text-center">
                                            <div class="ai-preview mb-3">
                                                <i class="fas fa-robot fa-3x" id="aiAvatarPreview"></i>
                                            </div>
                                            <h5 id="aiNamePreview">AI 助手</h5>
                                            <p class="text-muted" id="aiPersonalityPreview">友善親切</p>
                                            <div class="preview-message">
                                                <p class="mb-0" id="aiMessagePreview">您好！我是您的AI助手，很高興為您服務！</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Hidden file input -->
    <input type="file" id="fileInput" multiple style="display: none;">
    
    <!-- Game Modal -->
    <div class="modal fade" id="gameModal" tabindex="-1" aria-labelledby="gameModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="gameModalLabel">遊戲</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="gameContainer">
                        <!-- 遊戲內容將在這裡載入 -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Document Generator Modal -->
    <div class="modal fade" id="documentModal" tabindex="-1" aria-labelledby="documentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="documentModalLabel">AI文件生成器</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="docType" class="form-label">文件類型</label>
                            <select class="form-select" id="docType">
                                <option value="excel">Excel 試算表</option>
                                <option value="word">Word 文件</option>
                                <option value="ppt">PowerPoint 簡報</option>
                                <option value="google_sheets">Google Sheets</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="docLanguage" class="form-label">語言</label>
                            <select class="form-select" id="docLanguage">
                                <option value="zh-TW">繁體中文</option>
                                <option value="zh-CN">簡體中文</option>
                                <option value="en">English</option>
                                <option value="ja">日本語</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="docPrompt" class="form-label">文件描述</label>
                        <textarea class="form-control" id="docPrompt" rows="4" placeholder="描述您想要生成的文件內容..."></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="generationMethod" class="form-label">生成方式</label>
                            <select class="form-select" id="generationMethod">
                                <option value="ai">AI 智能生成</option>
                                <option value="template">範本生成</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="templateCategory" class="form-label">範本類別</label>
                            <select class="form-select" id="templateCategory">
                                <option value="business">商業文件</option>
                                <option value="financial">財務報表</option>
                                <option value="hr">人事管理</option>
                                <option value="project">專案管理</option>
                                <option value="marketing">行銷企劃</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="generateDocBtn">生成文件</button>
                </div>
                <div id="documentResult" class="modal-body" style="display:none;">
                    <div class="alert alert-success">
                        <strong>文件生成成功！</strong>
                        <a id="downloadDocLink" href="#" class="btn btn-success ms-2" download>下載文件</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    
    <div class="modal fade" id="qrCodeModal" tabindex="-1" aria-labelledby="qrCodeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="qrCodeModalLabel">QR碼生成器</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="qrText" class="form-label">輸入文字或網址</label>
                        <textarea class="form-control" id="qrText" rows="3" placeholder="輸入要生成QR碼的內容..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="qrSize" class="form-label">QR碼大小</label>
                        <select class="form-select" id="qrSize">
                            <option value="200">小 (200x200)</option>
                            <option value="300" selected>中 (300x300)</option>
                            <option value="400">大 (400x400)</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-primary" id="generateQRBtn">生成QR碼</button>
                    </div>
                    <div id="qrResult" class="mt-3 text-center" style="display:none;">
                        <img id="qrImage" src="" alt="QR Code" class="img-fluid">
                        <div class="mt-2">
                            <button type="button" class="btn btn-success" id="downloadQRBtn">下載QR碼</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="barcodeModal" tabindex="-1" aria-labelledby="barcodeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="barcodeModalLabel">條碼生成器</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="barcodeText" class="form-label">輸入數字或文字</label>
                        <input type="text" class="form-control" id="barcodeText" placeholder="輸入要生成條碼的內容...">
                    </div>
                    <div class="mb-3">
                        <label for="barcodeType" class="form-label">條碼類型</label>
                        <select class="form-select" id="barcodeType">
                            <option value="code128">Code 128</option>
                            <option value="ean13">EAN-13</option>
                            <option value="ean8">EAN-8</option>
                            <option value="code39">Code 39</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-primary" id="generateBarcodeBtn">生成條碼</button>
                    </div>
                    <div id="barcodeResult" class="mt-3 text-center" style="display:none;">
                        <img id="barcodeImage" src="" alt="Barcode" class="img-fluid" style="max-width: 400px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-html.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/enhanced_app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/file_handler.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tools.js') }}"></script>
    <script src="{{ url_for('static', filename='js/voice.js') }}"></script>
    <script src="{{ url_for('static', filename='js/canvas-effects.js') }}"></script>
    <script src="{{ url_for('static', filename='js/multiplayer-client.js') }}"></script>
    <script src="{{ url_for('static', filename='js/simple_games.js') }}"></script>
    <script src="{{ url_for('static', filename='js/document_generator.js') }}"></script>
    
    <!-- Socket.IO for Node.js support -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
    <script>
        // 全域檔案選擇函數
        function triggerFileSelect() {
            console.log('全域函數：觸發檔案選擇');
            const fileInput = document.getElementById('fileInputPanel');
            if (fileInput) {
                console.log('找到檔案輸入框，觸發點擊');
                
                // 嘗試多種方法觸發檔案選擇
                try {
                    // 方法1: 直接點擊
                    fileInput.click();
                    console.log('已觸發檔案選擇');
                } catch (e) {
                    console.error('檔案選擇失敗:', e);
                    
                    // 方法2: 創建新的檔案輸入框
                    const newInput = document.createElement('input');
                    newInput.type = 'file';
                    newInput.multiple = true;
                    newInput.style.display = 'none';
                    document.body.appendChild(newInput);
                    newInput.click();
                    newInput.remove();
                }
            } else {
                console.error('找不到檔案輸入框');
            }
        }
        
        // 開啟遊戲函數
        function openGame(gameType) {
            console.log('開啟遊戲:', gameType);
            
            // 顯示遊戲模態框
            const gameModal = new bootstrap.Modal(document.getElementById('gameModal'));
            const gameContainer = document.getElementById('gameContainer');
            const gameModalLabel = document.getElementById('gameModalLabel');
            
            // 清空遊戲容器
            gameContainer.innerHTML = '';
            
            // 根據遊戲類型設置標題和載入遊戲
            switch(gameType) {
                case 'tetris':
                    gameModalLabel.textContent = '俄羅斯方塊';
                    if (typeof initTetris === 'function') {
                        initTetris(gameContainer);
                    } else {
                        gameContainer.innerHTML = '<p class="text-center">遊戲載入中...</p>';
                        console.log('Tetris 遊戲函數尚未載入');
                    }
                    break;
                case 'mahjong':
                    gameModalLabel.textContent = '麻將遊戲';
                    if (typeof initMahjong === 'function') {
                        initMahjong(gameContainer);
                    } else {
                        gameContainer.innerHTML = '<p class="text-center">遊戲載入中...</p>';
                        console.log('Mahjong 遊戲函數尚未載入');
                    }
                    break;
                default:
                    gameModalLabel.textContent = '遊戲';
                    gameContainer.innerHTML = '<p class="text-center">遊戲載入失敗</p>';
            }
            
            // 顯示模態框
            gameModal.show();
        }
        
        // 初始化應用
        document.addEventListener('DOMContentLoaded', function() {
            console.log('實用工具已載入完成');
            console.log('載入簡化版遊戲系統...');
            
            // 初始化增強版AI助手
            if (typeof EnhancedAIAssistant !== 'undefined') {
                window.aiAssistant = new EnhancedAIAssistant();
            }
            
            console.log('簡化版遊戲系統已載入');
        });
    </script>

</body>
</html>